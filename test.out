  0%|          | 0/182 [00:00<?, ?it/s]/home/16amf8/anaconda3/lib/python3.8/site-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
/home/16amf8/crowd_counting/model.py:93: UserWarning: Implicit dimension choice for softmax has been deprecated. Change the call to include dim=X as an argument.
  x_att = nn.Softmax()(x_att)
  1%|          | 1/182 [00:00<00:52,  3.45it/s]  1%|          | 2/182 [00:00<00:53,  3.36it/s]test.py:326: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,3,1).imshow(img)
test.py:331: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,3,2)
test.py:336: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,3,4)
test.py:344: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,3,5)
test.py:351: MatplotlibDeprecationWarning: Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.
  plt.subplot(2,3,6)
  2%|▏         | 3/182 [00:00<00:54,  3.30it/s]  3%|▎         | 5/182 [00:01<00:44,  4.01it/s]  3%|▎         | 6/182 [00:01<00:48,  3.60it/s]  4%|▍         | 7/182 [00:01<00:53,  3.29it/s]  5%|▍         | 9/182 [00:02<00:43,  4.02it/s]  5%|▌         | 10/182 [00:02<00:48,  3.56it/s]  7%|▋         | 12/182 [00:02<00:40,  4.21it/s]  7%|▋         | 13/182 [00:02<00:33,  5.01it/s]  8%|▊         | 14/182 [00:03<00:41,  4.05it/s]  8%|▊         | 15/182 [00:03<00:38,  4.35it/s]  9%|▉         | 16/182 [00:03<00:51,  3.24it/s]  9%|▉         | 17/182 [00:04<00:57,  2.88it/s] 10%|▉         | 18/182 [00:04<01:05,  2.52it/s] 10%|█         | 19/182 [00:04<00:51,  3.16it/s] 11%|█         | 20/182 [00:05<00:55,  2.92it/s] 12%|█▏        | 21/182 [00:05<00:51,  3.12it/s] 12%|█▏        | 22/182 [00:06<00:59,  2.71it/s] 13%|█▎        | 23/182 [00:06<00:57,  2.75it/s] 13%|█▎        | 24/182 [00:06<00:48,  3.24it/s] 14%|█▎        | 25/182 [00:06<00:44,  3.57it/s] 14%|█▍        | 26/182 [00:07<00:53,  2.91it/s] 15%|█▍        | 27/182 [00:07<00:59,  2.59it/s] 15%|█▌        | 28/182 [00:08<00:59,  2.60it/s] 16%|█▌        | 29/182 [00:08<00:49,  3.12it/s] 17%|█▋        | 31/182 [00:08<00:40,  3.70it/s] 18%|█▊        | 32/182 [00:09<00:43,  3.46it/s] 18%|█▊        | 33/182 [00:09<00:43,  3.41it/s] 19%|█▊        | 34/182 [00:09<00:47,  3.14it/s] 19%|█▉        | 35/182 [00:10<00:47,  3.11it/s] 20%|█▉        | 36/182 [00:10<00:39,  3.74it/s] 20%|██        | 37/182 [00:10<00:31,  4.58it/s] 21%|██        | 38/182 [00:10<00:30,  4.74it/s] 21%|██▏       | 39/182 [00:10<00:30,  4.75it/s] 22%|██▏       | 40/182 [00:10<00:30,  4.64it/s] 23%|██▎       | 41/182 [00:11<00:28,  4.97it/s] 23%|██▎       | 42/182 [00:11<00:26,  5.21it/s] 24%|██▎       | 43/182 [00:11<00:32,  4.22it/s] 24%|██▍       | 44/182 [00:11<00:32,  4.30it/s] 25%|██▍       | 45/182 [00:12<00:29,  4.61it/s] 25%|██▌       | 46/182 [00:12<00:36,  3.68it/s] 26%|██▌       | 47/182 [00:12<00:31,  4.28it/s] 26%|██▋       | 48/182 [00:12<00:30,  4.34it/s] 27%|██▋       | 49/182 [00:13<00:30,  4.36it/s] 27%|██▋       | 50/182 [00:13<00:33,  3.91it/s] 28%|██▊       | 51/182 [00:13<00:36,  3.55it/s] 29%|██▊       | 52/182 [00:13<00:33,  3.94it/s] 29%|██▉       | 53/182 [00:14<00:30,  4.17it/s] 30%|██▉       | 54/182 [00:14<00:27,  4.66it/s] 30%|███       | 55/182 [00:14<00:27,  4.64it/s] 31%|███       | 56/182 [00:14<00:29,  4.34it/s] 31%|███▏      | 57/182 [00:14<00:29,  4.27it/s] 32%|███▏      | 58/182 [00:15<00:29,  4.17it/s] 32%|███▏      | 59/182 [00:15<00:34,  3.54it/s] 33%|███▎      | 60/182 [00:15<00:30,  3.97it/s] 34%|███▎      | 61/182 [00:15<00:28,  4.25it/s] 34%|███▍      | 62/182 [00:16<00:33,  3.56it/s] 35%|███▍      | 63/182 [00:16<00:37,  3.17it/s] 35%|███▌      | 64/182 [00:17<00:37,  3.16it/s] 36%|███▌      | 65/182 [00:17<00:30,  3.89it/s] 36%|███▋      | 66/182 [00:17<00:28,  4.02it/s] 37%|███▋      | 67/182 [00:17<00:31,  3.68it/s] 37%|███▋      | 68/182 [00:18<00:31,  3.65it/s] 38%|███▊      | 69/182 [00:18<00:26,  4.28it/s] 38%|███▊      | 70/182 [00:18<00:26,  4.25it/s] 39%|███▉      | 71/182 [00:18<00:25,  4.29it/s] 40%|███▉      | 72/182 [00:18<00:29,  3.79it/s] 40%|████      | 73/182 [00:19<00:33,  3.27it/s] 41%|████      | 74/182 [00:19<00:31,  3.47it/s] 41%|████      | 75/182 [00:19<00:32,  3.28it/s] 42%|████▏     | 76/182 [00:20<00:30,  3.43it/s] 42%|████▏     | 77/182 [00:20<00:25,  4.10it/s] 43%|████▎     | 78/182 [00:20<00:29,  3.49it/s] 43%|████▎     | 79/182 [00:20<00:28,  3.68it/s] 44%|████▍     | 80/182 [00:21<00:24,  4.16it/s] 45%|████▍     | 81/182 [00:21<00:27,  3.70it/s] 45%|████▌     | 82/182 [00:21<00:22,  4.37it/s] 46%|████▌     | 83/182 [00:21<00:25,  3.93it/s] 46%|████▌     | 84/182 [00:22<00:24,  3.97it/s] 47%|████▋     | 85/182 [00:22<00:26,  3.63it/s] 47%|████▋     | 86/182 [00:22<00:26,  3.63it/s] 48%|████▊     | 87/182 [00:22<00:21,  4.34it/s] 48%|████▊     | 88/182 [00:22<00:18,  5.21it/s] 49%|████▉     | 89/182 [00:23<00:23,  3.98it/s] 49%|████▉     | 90/182 [00:23<00:25,  3.56it/s] 50%|█████     | 91/182 [00:23<00:21,  4.31it/s] 51%|█████     | 93/182 [00:24<00:17,  5.23it/s] 52%|█████▏    | 94/182 [00:24<00:17,  5.02it/s] 52%|█████▏    | 95/182 [00:24<00:15,  5.74it/s] 53%|█████▎    | 96/182 [00:24<00:18,  4.72it/s] 53%|█████▎    | 97/182 [00:25<00:21,  3.87it/s] 54%|█████▍    | 98/182 [00:25<00:24,  3.37it/s] 54%|█████▍    | 99/182 [00:25<00:21,  3.93it/s] 55%|█████▍    | 100/182 [00:25<00:18,  4.51it/s] 55%|█████▌    | 101/182 [00:25<00:16,  4.87it/s] 56%|█████▌    | 102/182 [00:26<00:16,  4.94it/s] 57%|█████▋    | 103/182 [00:26<00:20,  3.94it/s] 57%|█████▋    | 104/182 [00:26<00:19,  3.91it/s] 58%|█████▊    | 105/182 [00:26<00:18,  4.15it/s] 58%|█████▊    | 106/182 [00:27<00:21,  3.60it/s] 59%|█████▉    | 107/182 [00:27<00:19,  3.78it/s] 59%|█████▉    | 108/182 [00:27<00:23,  3.20it/s] 60%|█████▉    | 109/182 [00:28<00:23,  3.17it/s] 60%|██████    | 110/182 [00:28<00:22,  3.13it/s] 61%|██████    | 111/182 [00:28<00:20,  3.40it/s] 62%|██████▏   | 113/182 [00:29<00:17,  3.87it/s] 63%|██████▎   | 114/182 [00:29<00:17,  3.95it/s] 63%|██████▎   | 115/182 [00:29<00:17,  3.83it/s] 64%|██████▎   | 116/182 [00:30<00:21,  3.06it/s] 64%|██████▍   | 117/182 [00:30<00:18,  3.44it/s] 65%|██████▍   | 118/182 [00:30<00:21,  3.00it/s] 65%|██████▌   | 119/182 [00:31<00:19,  3.17it/s] 66%|██████▌   | 120/182 [00:31<00:15,  3.98it/s] 66%|██████▋   | 121/182 [00:31<00:15,  3.82it/s] 67%|██████▋   | 122/182 [00:31<00:14,  4.17it/s] 68%|██████▊   | 123/182 [00:31<00:14,  4.08it/s] 69%|██████▊   | 125/182 [00:32<00:12,  4.64it/s] 69%|██████▉   | 126/182 [00:32<00:15,  3.70it/s] 70%|██████▉   | 127/182 [00:32<00:13,  3.96it/s] 70%|███████   | 128/182 [00:32<00:11,  4.57it/s] 71%|███████   | 129/182 [00:33<00:10,  4.98it/s] 71%|███████▏  | 130/182 [00:33<00:13,  3.78it/s] 72%|███████▏  | 131/182 [00:33<00:11,  4.27it/s] 73%|███████▎  | 132/182 [00:33<00:12,  4.16it/s] 73%|███████▎  | 133/182 [00:34<00:11,  4.15it/s] 74%|███████▎  | 134/182 [00:34<00:13,  3.67it/s] 74%|███████▍  | 135/182 [00:34<00:13,  3.49it/s] 75%|███████▍  | 136/182 [00:35<00:13,  3.34it/s] 75%|███████▌  | 137/182 [00:35<00:12,  3.51it/s] 76%|███████▌  | 138/182 [00:35<00:12,  3.41it/s] 76%|███████▋  | 139/182 [00:36<00:13,  3.14it/s] 77%|███████▋  | 140/182 [00:36<00:13,  3.06it/s] 77%|███████▋  | 141/182 [00:36<00:11,  3.45it/s] 78%|███████▊  | 142/182 [00:36<00:10,  3.88it/s] 79%|███████▊  | 143/182 [00:37<00:11,  3.54it/s] 79%|███████▉  | 144/182 [00:37<00:11,  3.19it/s] 80%|███████▉  | 145/182 [00:37<00:12,  3.00it/s] 80%|████████  | 146/182 [00:38<00:12,  2.83it/s] 81%|████████  | 147/182 [00:38<00:12,  2.89it/s] 81%|████████▏ | 148/182 [00:38<00:10,  3.23it/s] 82%|████████▏ | 149/182 [00:39<00:11,  2.94it/s] 82%|████████▏ | 150/182 [00:39<00:10,  3.06it/s] 83%|████████▎ | 151/182 [00:39<00:08,  3.71it/s] 84%|████████▎ | 152/182 [00:40<00:11,  2.69it/s] 84%|████████▍ | 153/182 [00:40<00:09,  3.02it/s] 85%|████████▍ | 154/182 [00:40<00:09,  2.95it/s] 85%|████████▌ | 155/182 [00:41<00:09,  2.79it/s] 86%|████████▌ | 156/182 [00:41<00:07,  3.37it/s] 86%|████████▋ | 157/182 [00:41<00:06,  4.01it/s] 87%|████████▋ | 158/182 [00:41<00:05,  4.21it/s] 87%|████████▋ | 159/182 [00:42<00:07,  3.28it/s] 88%|████████▊ | 160/182 [00:42<00:05,  3.79it/s] 88%|████████▊ | 161/182 [00:42<00:06,  3.46it/s] 89%|████████▉ | 162/182 [00:43<00:06,  2.99it/s] 90%|████████▉ | 163/182 [00:43<00:06,  2.83it/s] 90%|█████████ | 164/182 [00:44<00:06,  2.91it/s] 91%|█████████ | 165/182 [00:44<00:06,  2.74it/s] 91%|█████████ | 166/182 [00:44<00:05,  3.06it/s] 92%|█████████▏| 167/182 [00:44<00:04,  3.35it/s] 92%|█████████▏| 168/182 [00:45<00:04,  3.17it/s] 93%|█████████▎| 169/182 [00:45<00:03,  3.83it/s] 93%|█████████▎| 170/182 [00:45<00:03,  3.56it/s] 94%|█████████▍| 171/182 [00:45<00:02,  4.38it/s] 95%|█████████▍| 172/182 [00:46<00:02,  3.84it/s] 95%|█████████▌| 173/182 [00:46<00:02,  3.53it/s] 96%|█████████▌| 174/182 [00:46<00:02,  3.81it/s] 96%|█████████▌| 175/182 [00:46<00:01,  4.64it/s] 97%|█████████▋| 177/182 [00:47<00:01,  4.49it/s] 98%|█████████▊| 178/182 [00:47<00:00,  4.21it/s] 98%|█████████▊| 179/182 [00:47<00:00,  4.13it/s] 99%|█████████▉| 180/182 [00:47<00:00,  4.58it/s] 99%|█████████▉| 181/182 [00:48<00:00,  4.98it/s]100%|██████████| 182/182 [00:48<00:00,  5.62it/s]
Model Summary: 105 layers, 25414908 parameters, 25414908 gradients
 * MAE_Count_0 83.842 
 * MSE 141.262 
 * MAE_Count_1 96.885 
 * MAE_Count_2 2500.298 
 * MAE_Count_total 212.136 
 
 * MAE_Best 61.075
